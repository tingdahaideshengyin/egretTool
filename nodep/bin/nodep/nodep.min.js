var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function s(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}(),Map=function(){function t(){this._keys=[],this._values=[]}return t.prototype.set=function(t,e){var i=this._keys.indexOf(t);i>=0?(this._keys[i]=t,this._values[i]=e):(this._keys.push(t),this._values.push(e))},t.prototype["delete"]=function(t){var e,i=this._keys.indexOf(t);return i>=0&&(this._keys.splice(i,1),e=this._values.splice(i,1)[0]),e},t.prototype.log=function(){LogTrace.log("mapInfo=k:"+this._keys.length+"v:"+this._values.length)},t.prototype.get=function(t){var e=this._keys.indexOf(t);return e>=0?this._values[e]:null},t.prototype.has=function(t){var e=this._keys.indexOf(t);return e>=0},t.prototype.forEach=function(t,e){for(var i=0;i<this._values.length;i++)t.call(e,this._values[i])},t.prototype.clear=function(){this._keys=[],this._values=[]},t}();__reflect(Map.prototype,"Map");var UTF8=function(){function t(){}return t.stringToByteArray=function(t){for(var e=[],i=0;i<t.length;++i){var s=t.charCodeAt(i);127>s?e.push(s):2047>s?(e.push(s>>6&31|192),e.push(63&s|128)):65535>s?(e.push(s>>12&15|224),e.push(s>>6&63|128),e.push(63&s|128)):(e.push(s>>18&248|240),e.push(s>>12&63|128),e.push(s>>6&63|128),e.push(63&s|128))}return new Uint8Array(e)},t.byteArrayToString=function(t){for(var e="",i=t.length,s=0,n=0;i>s;){var r=t[s];if(0===(128&r))n=r,s+=1;else if(r>>5<<5===192){var o=t[s+1];n=(31&r)<<6|63&o,s+=2}else if(r>>4<<4===224){var o=t[s+1],a=t[s+2];n=(15&r)<<12|(63&o)<<6|63&a,s+=3}else{if(r>>3<<3!==240)throw new Error("can not decode utf8 string");var o=t[s+1],a=t[s+2],h=t[s+3];n=15&r<<18|o<<12&63|a<<6&63|63&h,s+=4}e+=String.fromCharCode(n)}return e},t}();__reflect(UTF8.prototype,"UTF8");var TweenTs=function(){function t(){this._ts=[],this._index=0}return t.removeTweens=function(t){if(this._tweenMap.has(t)){var e=this._tweenMap["delete"](t);RenderManager.getIns().unregistRender(e),e.dispose()}},t.get=function(e,i,s,n,r,o){void 0===i&&(i=!0),void 0===s&&(s=1),void 0===n&&(n=null),void 0===r&&(r=null),void 0===o&&(o=null),i&&this.removeTweens(e);var a=new t;return a._tw=e,a._loop=s,a._comH=n,a._tO=r,a._args=o,this._tweenMap.set(e,a),a},t.prototype.dispose=function(){for(this._comH=null,this._tw=null,this._tO=null,this._args=null;this._ts.length>0;)this._ts.pop().dispose();this._ts=null,this._focusT=null,this._curObj=null,this._startObj=null},Object.defineProperty(t.prototype,"groupName",{set:function(t){},enumerable:!0,configurable:!0}),t.prototype.renderUpdate=function(e){if(this._curObj){this._curT+=e;var i;for(i in this._curObj)null!=this._focusT.ease?this._tw[i]=this._startObj[i]+this._focusT.ease.call(nodep.Ease,this._curT/this._focusT.durT)*this._curObj[i]:this._tw[i]=this._startObj[i]+Math.min(this._curT/this._focusT.durT,1)*this._curObj[i];if(this._curT>=this._focusT.durT){if(this._index++,this._index>=this._ts.length){if(null!=this._comH&&this._comH.apply(this._tO,this._args),this._loop--,this._loop<=0)return void t.removeTweens(this._tw);this._index=0}this.setFocusToItem(this._ts[this._index])}}},t.prototype.setFocusToItem=function(t){this._focusT=t,this._curObj=new Object,this._startObj=new Object;var e;for(e in t.props)this._curObj[e]=t.props[e]-this._tw[e],this._startObj[e]=this._tw[e];this._curT=0},t.prototype.to=function(t,e,i){void 0===i&&(i=null);var s=new nodep.TweenItem("go");return s.durT=e,s.ease=i,s.props=t,this._ts.push(s),this._focusT||this.setFocusToItem(s),RenderManager.getIns().registRender(this),this},t.prototype.from=function(t,e,i){return void 0===i&&(i=null),this},t.prototype.wait=function(t){return this},t.prototype.call=function(t,e){return this},t._tweenMap=new Map,t}();__reflect(TweenTs.prototype,"TweenTs",["IRender"]);var nodep;!function(t){var e=function(){function t(){}return t.backOut=function(t){return--t*t*(2.7*t+1.7)+1},t}();t.Ease=e,__reflect(e.prototype,"nodep.Ease")}(nodep||(nodep={}));var GameWindow=function(t){function e(e,i,s){void 0===s&&(s=-1);var n=t.call(this)||this;return n.__inited=!1,n.__align="NONE",n.__offsetX=0,n.__offsetY=0,n.layerType="",n.pop=!1,n.created=!1,n._backgrundColor=-1,n.needDelayRemove=0,n.isFull=!1,n._backgrundColor=s,n.typeName=e,n.layerType=i,n.skinName=egret.getQualifiedClassName(n)+"Skin",n}return __extends(e,t),e.prototype.partAdded=function(e,i){i.name=e,e.indexOf("helpTip_")>=0&&NodepManager.getIns().addHelpTipHandler(i),t.prototype.partAdded.call(this,e,i)},e.prototype.childrenCreated=function(){if(t.prototype.childrenCreated.call(this),this._backgrundColor>=0){var i=new egret.RenderTexture;e._backShape.graphics.clear(),e._backShape.graphics.beginFill(this._backgrundColor),e._backShape.graphics.drawRect(0,0,1,1),e._backShape.graphics.endFill(),i.drawToTexture(e._backShape),this._backBt=new egret.Bitmap(i),this.addChildAt(this._backBt,0)}this.visible=!0,this.created=!0,this._initW=this.width,this._initH=this.height,1==NodepConfig.auto&&this.autoScale(),this.resize(),this.updateSelf(),WinsManager.getIns().checkLayerVisible()},e.prototype.updateSelf=function(){},e.prototype.reOpen=function(){this.visible=!0,1==NodepConfig.auto&&this.autoScale(),this._backBt&&this.addChildAt(this._backBt,0),this.resize(),this.created&&this.updateSelf(),WinsManager.getIns().checkLayerVisible()},e.prototype.addStageClose=function(){this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.autoCloseHandler,this)},e.prototype.autoCloseHandler=function(t){var e=t.target;e instanceof eui.Rect&&e.parent&&e.parent instanceof GameLayer&&WinsManager.getIns().closeWin(this)},e.prototype.update=function(t,e){},e.prototype.beforeClose=function(){return this.stage&&this.stage.hasEventListener(egret.TouchEvent.TOUCH_TAP)&&this.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.autoCloseHandler,this),this._backBt&&this._backBt.parent&&(this._backBt.parent.removeChild(this._backBt),this.needDelayRemove=1),!0},e.prototype.resize=function(){switch(this.__align){case AlignType.CENTER_STAGE:1==NodepConfig.auto&&null!=this.parent?(this.parent.x=Math.floor(WinsManager.stageWidth/2),this.parent.y=Math.floor(WinsManager.stageHeight/2)):(this.x=Math.floor(WinsManager.stageWidth/2),this.y=Math.floor(WinsManager.stageHeight/2));break;case AlignType.TOP_LEFT:this.x=this.__offsetX,this.y=this.__offsetY;break;case AlignType.TOP_CENTER:this.x=(WinsManager.stageWidth-this.width*this.scaleX)/2+this.__offsetX,this.y=this.__offsetY;break;case AlignType.TOP_RIGHT:this.x=WinsManager.stageWidth-this.width*this.scaleX+this.__offsetX,this.y=this.__offsetY;break;case AlignType.CENTER:this.x=(WinsManager.stageWidth-this.width*this.scaleX)/2+this.__offsetX,this.y=(WinsManager.stageHeight-this.height*this.scaleY)/2+this.__offsetY;break;case AlignType.BOTTOM_LEFT:this.x=this.__offsetX,this.y=WinsManager.stageHeight-this.height*this.scaleY+this.__offsetY;break;case AlignType.BOTTOM_CENTER:this.x=this.x=(WinsManager.stageWidth-this.width*this.scaleX)/2+this.__offsetX,this.y=WinsManager.stageHeight-this.height*this.scaleY+this.__offsetY;break;case AlignType.BOTTOM_RIGHT:this.x=WinsManager.stageWidth-this.width*this.scaleX+this.__offsetX,this.y=WinsManager.stageHeight-this.height*this.scaleY+this.__offsetY}null!=this._backBt&&(this._backBt.scaleX=this.width,this._backBt.scaleY=this.height)},e.prototype.active=function(){},e.prototype.align=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0),this.__align=t,this.__offsetX=e*this.scaleX,this.__offsetY=i*this.scaleY,null!=this.stage&&this.resize()},e.prototype.addEventTap=function(t,e){if(void 0===e&&(e=""),t instanceof egret.DisplayObject)t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.eventTapHandler,this);else switch(typeof t){case"string":""==e?this.getChildByName(t).addEventListener(egret.TouchEvent.TOUCH_TAP,this.eventTapHandler,this):this.getChildByName(e).getChildByName(t).addEventListener(egret.TouchEvent.TOUCH_TAP,this.eventTapHandler,this);break;case"object":var i;for(i in t)this[t[i]].addEventListener(egret.TouchEvent.TOUCH_TAP,this.eventTapHandler,this);break;default:throw new Error(NodepErrorType.PARAM_TYPE_ERROR)}},e.prototype.tapCallback=function(t){},e.prototype.eventTapHandler=function(t){t.currentTarget instanceof eui.Image&&(t.currentTarget.scaleX=t.currentTarget.scaleY=.9,DelayCall.call(20,function(t){t.scaleX=t.scaleY=1},this,[t.currentTarget])),this.tapCallback(t.currentTarget.name)},e.prototype.popup=function(t,e,i){void 0===t&&(t=200),void 0===e&&(e=0),void 0===i&&(i=!0),1==NodepConfig.auto&&null!=this.parent?(this.parent.alpha=0,this.parent.scaleX=e,this.parent.scaleY=e,TweenTs.removeTweens(this.parent),TweenTs.get(this.parent).to({alpha:1,scaleX:1,scaleY:1},t,i?nodep.Ease.backOut:null)):0==NodepConfig.auto&&(this.alpha=0,this.scaleX=e,this.scaleY=e,TweenTs.removeTweens(this),TweenTs.get(this).to({alpha:1,scaleX:1,scaleY:1},t,i?nodep.Ease.backOut:null))},e.prototype.popOut=function(t,e){return void 0===t&&(t=200),void 0===e&&(e=0),this._backBt&&this._backBt.parent&&(this._backBt.parent.removeChild(this._backBt),this.needDelayRemove=1),this.needDelayRemove=t,1==NodepConfig.auto&&null!=this.parent?(TweenTs.removeTweens(this.parent),TweenTs.get(this.parent).to({alpha:0,scaleX:e,scaleY:e},t)):0==NodepConfig.auto&&(TweenTs.removeTweens(this),TweenTs.get(this).to({alpha:0,scaleX:e,scaleY:e},t)),!0},e.prototype.getTxtInput=function(t){return this.getChildByName(t)},e.prototype.autoScale=function(){this.scaleX=WinsManager.getIns().$autoScaleX,this.scaleY=WinsManager.getIns().$autoScaleY;var t=this._initH*this.scaleY;this.height=this._initH-(t-this._initH)/WinsManager.getIns().$autoScaleY},e.prototype.justScale=function(){this.scaleX=WinsManager.getIns().$autoScaleX,this.scaleY=WinsManager.getIns().$autoScaleY},e.prototype.sound=function(t,e){void 0===e&&(e=1e3),SoundManager.getIns().playSound(t,1,e)},e._backShape=new egret.Shape,e}(eui.Component);__reflect(GameWindow.prototype,"GameWindow",["eui.UIComponent","egret.DisplayObject"]);var GameComp=function(t){function e(e){void 0===e&&(e=0);var i=t.call(this)||this;return i.created=!1,i.skinName=egret.getQualifiedClassName(i)+"Skin",i.index=e,i}return __extends(e,t),e.prototype.update=function(t,e){},e.prototype.partAdded=function(e,i){i.name=e,e.indexOf("helpTip_")>=0&&NodepManager.getIns().addHelpTipHandler(i),t.prototype.partAdded.call(this,e,i)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.created=!0,this.updateSelf()},Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t,this.updateSelf()},enumerable:!0,configurable:!0}),e.prototype.updateSelf=function(){},e.prototype.addEventTap=function(t,e){if(void 0===e&&(e=""),t instanceof egret.DisplayObject)t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.eventTapHandler,this);else switch(typeof t){case"string":""==e?this.getChildByName(t).addEventListener(egret.TouchEvent.TOUCH_TAP,this.eventTapHandler,this):this.getChildByName(e).getChildByName(t).addEventListener(egret.TouchEvent.TOUCH_TAP,this.eventTapHandler,this);break;case"object":var i;for(i in t)this.getChildByName(t[i]).addEventListener(egret.TouchEvent.TOUCH_TAP,this.eventTapHandler,this);break;default:throw new Error(NodepErrorType.PARAM_TYPE_ERROR)}},e.prototype.tapCallback=function(t){},e.prototype.eventTapHandler=function(t){t.currentTarget instanceof eui.Image&&(t.currentTarget.scaleX=t.currentTarget.scaleY=.9,DelayCall.call(20,function(t){t.scaleX=t.scaleY=1},this,[t.currentTarget])),this.tapCallback(t.currentTarget.name)},e}(eui.Component);__reflect(GameComp.prototype,"GameComp");var HViewStack=function(){function t(t){this._keys=[],this._focusIndex=0,this._box=t}return t.prototype.update=function(t,e){for(var i=0;i<this._box.numChildren;i++)this._box.getChildAt(i).update(t,e)},t.prototype.setPages=function(e){for(var i=0;i<e.length;i++){var s=egret.getQualifiedClassName(e[i]);this._keys.push(s),t._pageMaker.set(s,e[i])}},t.prototype.removeAll=function(){this._focus=null,this._box.removeChildren()},t.prototype.initPageTo=function(e,i){var s=t.getPage(this._keys[e]);TweenTs.removeTweens(s),s.data=i,this._focus&&(this._box.removeChild(this._focus),this._focus=null),this._focusIndex=e,this._focus=s,s.x=s.y=0,this._box.addChild(s)},t.prototype.changeToPage=function(e,i){if(!this._focus)return void this.initPageTo(e,i);var s=t.getPage(this._keys[e]);DelayCall.removeCall("hviewDelayRemove_"+s.hashCode);var n=this._focus,r=0;this._focusIndex;e>this._focusIndex?(TweenTs.removeTweens(s),s.x=this._box.width,TweenTs.get(s).to({x:0},400),s.data=i,this._box.addChild(s),r=-this._box.width,this._focus=s,this._focusIndex=e):e<this._focusIndex?(TweenTs.removeTweens(s),s.x=-this._box.width,TweenTs.get(s).to({x:0},400),s.data=i,this._box.addChild(s),r=this._box.width,this._focus=s,this._focusIndex=e):this.initPageTo(e,i),0!=r&&this._focus!=n&&(TweenTs.removeTweens(n),TweenTs.get(n).to({x:r},300),DelayCall.call(300,this.removeHandler,this,[n],1,"hviewDelayRemove_"+n.hashCode))},t.prototype.removeHandler=function(t){t.parent&&t.parent.removeChild(t)},t.getPage=function(t){var e=this._pageMaker.get(t);return this._pageMap.has(t)||this._pageMap.set(t,new e),this._pageMap.get(t)},t._pageMaker=new Map,t._pageMap=new Map,t}();__reflect(HViewStack.prototype,"HViewStack");var TabBox=function(t){function e(e,i,s,n,r){void 0===s&&(s=null),void 0===n&&(n=null),void 0===r&&(r=30);var o=t.call(this)||this;o._urls=[],o._imgs=[],o._index=0,o._loaders=[],o._showIndex=0,o._stcs=[],o._setImg=null,o._unsetImg=null,o._sw=0,o._sw=r,o._setImg=s,o._unsetImg=n,o._w=e,o._h=i;for(var a=0;2>a;a++){var h=new Loader;h.width=o._w,h.height=o._h,o._loaders.push(h),o.addChild(h)}return o}return __extends(e,t),e.prototype.setDatas=function(t){NodepUtil.listFillTo01(t,[this._imgs,this._urls]),this._index=0,null!=this._setImg&&null!=this._unsetImg&&NodepUtil.fill(this._stcs,eui.Image,this._imgs.length,!0,this);for(var e=(this._w-this._stcs.length*this._sw)/2,i=0;i<this._stcs.length;i++)this._stcs[i].x=e,e+=this._sw,this._stcs[i].y=this._h-this._sw;this.updateShow()},e.prototype.updateShow=function(){var t,e,i=this._showIndex%2;0==i?(t=this._loaders[0],e=this._loaders[1]):(t=this._loaders[1],e=this._loaders[0]),TweenTs.removeTweens(e),TweenTs.get(e).to({alpha:0},300),TweenTs.removeTweens(t),TweenTs.get(t).to({alpha:1},300),t.url=this._imgs[this._index];var s=this._index+1;s>=this._imgs.length&&(s=0),DelayCall.call(300,this.setLast,this,[e,s]);for(var n=0;n<this._stcs.length;n++)this._index==n?this._stcs[n].source=this._setImg:this._stcs[n].source=this._unsetImg},e.prototype.setLast=function(t,e){t.url=e},e.prototype.changeImg=function(){this._index+=1,this._index>=this._imgs.length&&(this._index=0),this._showIndex++,this.updateShow()},e.prototype.start=function(t){DelayCall.call(t,this.changeImg,this,null,0,"frameNode_tabbox"+this.hashCode,!0),this.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tapHandler,this)},e.prototype.tapHandler=function(t){var e=this._urls[this._index];e&&""!=e&&window.open(e,"_blank")},e.prototype.stop=function(){DelayCall.removeCall("frameNode_tabbox"+this.hashCode),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.tapHandler,this)},e.prototype.gc=function(){},e}(egret.DisplayObjectContainer);__reflect(TabBox.prototype,"TabBox");var NoticeBar=function(){function t(t,e){this._txts=[],this._urls=[],this._index=0,this._durT=0,this._hash=0,this._hash=Math.random(),this._g=t,this._label=this._g.getChildAt(0),this._label.text="",this._right=this._g.width-e,this._left=this._label.x;var i=new eui.Rect(this._right-this._left,this._g.height,0);i.x=this._left,this._g.addChild(i),this._label.mask=i}return t.prototype.setDatas=function(t){NodepUtil.listFillTo01(t,[this._txts,this._urls]),this._index=0},t.prototype.playOne=function(){DelayCall.removeCall("frameNodep_noticeBar"+this._hash);var t=this._txts[this._index];this._label.text=t,this._label.x=this._right,DelayCall.call(1,this.startPlay,this,null,1,"frameworknoticeBar"+this._g.hashCode,!0)},t.prototype.startPlay=function(){var t=(this._right-this._left+this._label.textWidth)/(this._right-this._left)*this._durT;t<this._durT&&(t=this._durT),TweenTs.removeTweens(this._label),TweenTs.get(this._label).to({x:this._left/2-this._label.textWidth},t),DelayCall.call(t+1e3,this.nextOne,this,null,1,"frameNodep_noticeBar"+this._hash)},t.prototype.nextOne=function(){this._index++,this._index>=this._txts.length&&(this._index=0),this.playOne()},t.prototype.tapHandler=function(t){var e=this._urls[this._index];e&&""!=e&&window.open(e,"_blank")},t.prototype.start=function(t){void 0===t&&(t=8e3),this._durT=t,this.playOne(),this._g.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this._g.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tapHandler,this)},t.prototype.stop=function(){TweenTs.removeTweens(this._label),DelayCall.removeCall("frameworknoticeBar"+this._g.hashCode),DelayCall.removeCall("frameNodep_noticeBar"+this._hash),this._g.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tapHandler,this)},t}();__reflect(NoticeBar.prototype,"NoticeBar");var NodepConfig=function(){function t(){}return t.init=function(){for(var t=["isTest","isDebug","bgVolume","appMode","auto"],e=0;e<t.length;e++)window.hasOwnProperty(t[e])&&(this[t[e]]=window[t[e]]);LogTrace.log("init args set:"+t.toString())},t.isTest=0,t.isDebug=0,t.bgVolume=.1,t.appMode=1,t.auto=1,t}();__reflect(NodepConfig.prototype,"NodepConfig");var CallBackVO=function(){function t(t,e,i){void 0===i&&(i=null),this.args=null,this.callBack=t,this.thisObj=e,this.args=i}return t.prototype.call=function(t){void 0===t&&(t=!0),null!=this.callBack&&null!=this.thisObj&&this.callBack.apply(this.thisObj,this.args),t&&(this.callBack=null,this.thisObj=null)},t}();__reflect(CallBackVO.prototype,"CallBackVO");var AlignType=function(){function t(){}return t.TOP_LEFT="TOP_LEFT",t.TOP_CENTER="TOP_CENTER",t.TOP_RIGHT="TOP_RIGHT",t.CENTER="CENTER",t.BOTTOM_LEFT="BOTTOM_LEFT",t.BOTTOM_CENTER="BOTTOM_CENTER",t.BOTTOM_RIGHT="BOTTOM_RIGHT",t.NONE="NONE",t.CENTER_STAGE="CENTER_STAGE",t}();__reflect(AlignType.prototype,"AlignType");var LayerType=function(){function t(){}return t.LAYER_GROUND="LAYER_GROUND",t.LAYER_BATTLE="LAYER_BATTLE",t.LAYER_MENU="LAYER_MENU",t.LAYER_UI="LAYER_UI",t.LAYER_POP="LAYER_POP",t.LAYER_TIP="LAYER_TIP",t}();__reflect(LayerType.prototype,"LayerType");var NodepErrorType=function(){function t(){}return t.LAYER_NO_EXISTENT="LAYER_NO_EXISTENT",t.PARAM_TYPE_ERROR="PARAM_TYPE_ERROR",t.ERROR_CODE="ERROR_CODE",t.NO_ALREADY_EXIST="NO_ALREADY_EXIST",t}();__reflect(NodepErrorType.prototype,"NodepErrorType");var AlphaRender=function(){function t(e,i,s){void 0===i&&(i=50),void 0===s&&(s=.1),this._id=0,this._lastDurT=0,this._id=t._stepId,t._stepId++,this._target=e,this._startArg=e.alpha,this._arg=s,this._durTime=i}return t.createApr=function(e,i,s){if(void 0===i&&(i=50),void 0===s&&(s=.1),!this._rds.has(e)){var n=new t(e,i,s);this._rds.set(e,n)}},t.startStatic=function(t,e,i,s){void 0===e&&(e=0),void 0===i&&(i=50),void 0===s&&(s=.1),this.createApr(t,i,s);var n=this._rds.get(t);n.start(e)},t.stopStatic=function(t){var e=this._rds.get(t);e&&e.stop()},t.prototype.renderUpdate=function(t){this._lastDurT+=t,this._lastDurT<this._durTime||(this._lastDurT=0,this._arg>0&&this._target.alpha>1?this._arg=-this._arg:this._arg<0&&this._target.alpha<=0&&(this._arg=-this._arg),this._target.alpha+=this._arg)},t.prototype.start=function(t){void 0===t&&(t=0),RenderManager.getIns().registRender(this),t>0&&DelayCall.call(t,this.stopSelf,this,null,1,"framework_nodep_aloharender_"+this._id,!0)},t.prototype.stopSelf=function(){this.stop()},t.prototype.stop=function(){DelayCall.removeCall("framework_nodep_aloharender_"+this._id),RenderManager.getIns().unregistRender(this),this._target.alpha=this._startArg},t.prototype.dispose=function(){RenderManager.getIns().unregistRender(this),this._target.alpha=this._startArg,this._target=null},t._stepId=0,t._rds=new Map,t}();__reflect(AlphaRender.prototype,"AlphaRender",["IRender"]);var FadeEffect=function(){function t(t,e,i,s,n){void 0===n&&(n=0),this._target=t,this._from=this._target.alpha,this._to=n,this._bt=this._to-this._from,this._callBack=i,this._thisObj=s,this._durT=e,this._turnT=0,RenderManager.getIns().registRender(this)}return t.prototype.renderUpdate=function(t){this._turnT+=t,this._target.alpha=this._from+this._bt*this._turnT/this._durT,this._turnT>=this._durT&&(this._target.alpha=this._to,RenderManager.getIns().unregistRender(this),null!=this._callBack&&null!=this._thisObj&&this._callBack.apply(this._thisObj))},t.fadeIn=function(e,i,s,n){new t(e,i,s,n,1)},t.fadeOut=function(e,i,s,n){new t(e,i,s,n,0)},t}();__reflect(FadeEffect.prototype,"FadeEffect",["IRender"]);var GroupResManager=function(){function t(){this._loadingGroups=[],this._loadingMap=new Map,this._showBars=[]}return t.getIns=function(){return t._ins||(t._ins=new t),t._ins},t.prototype.registLoadingWindow=function(t,e,i){this._winName=t,this._progressUpdateType=e,this._loadingWindow=i,RES.setMaxRetryTimes(2),RES.setMaxLoadingThread(3)},t.prototype.loadGroup=function(t,e,i,s,n,r){void 0===s&&(s=!0),void 0===n&&(n=0),void 0===r&&(r=null);var o=new CallBackVO(e,i,r);if(RES.isGroupLoaded(t))return void o.call();this._loadingMap.set(t,o);var a=0==this._loadingGroups.length,h=!0;this._loadingGroups.indexOf(t)<0?(this._loadingGroups.push(t),h=!0):h=!1,s&&(this._showBars.push(t),WinsManager.getIns().openWindow(this._loadingWindow)),a&&(RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this)),h&&RES.loadGroup(t,n)},t.prototype.onResourceLoadComplete=function(t){var e=t.groupName,i=this._loadingGroups.indexOf(e);i>=0&&this._loadingGroups.splice(i,1);var s=this._loadingMap.get(e);null!=s&&s.call(),this._loadingMap.set(e,null),0==this._loadingGroups.length&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this)),i=this._showBars.indexOf(e),i>=0&&this._showBars.splice(i,1),0==this._showBars.length&&WinsManager.getIns().closeWin(this._loadingWindow)},t.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},t.prototype.onResourceProgress=function(t){WinsManager.getIns().updateWin(this._progressUpdateType,[this._winName],[t.itemsLoaded,t.itemsTotal])},t}();__reflect(GroupResManager.prototype,"GroupResManager");var LogTrace=function(){function t(){}return t.log=function(t){1==NodepConfig.isDebug&&console.log(t)},t.logTime=function(){1==NodepConfig.isDebug&&console.log("time:"+(new Date).getTime())},t.errorInfo=function(t){console.log("warnInfo:"+t)},t}();__reflect(LogTrace.prototype,"LogTrace");var NodepManager=function(){function t(){this.isActive=!0,this._colorFlilter=new egret.ColorMatrixFilter([.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0]),this._colorFlilter2=new egret.ColorMatrixFilter([.15,.3,0,0,0,.15,.3,0,0,0,.15,.3,0,0,0,0,0,0,1,0]),this._infoTMap=new Map,this._tipInit=!1}return t.getIns=function(){return null==t._ins&&(t._ins=new t),t._ins},t.prototype.regsitErrorOkHandler=function(t,e,i){this._okHandler=t,this._errorHandler=e,this._ht=i},t.prototype.errorInfo=function(t){null!=this._infoTMap.get(t)&&egret.getTimer()<this._infoTMap.get(t)||null!=this._errorHandler&&(this._infoTMap.set(t,egret.getTimer()+500),this._errorHandler.apply(this._ht,[t]))},t.prototype.okInfo=function(t){null!=this._okHandler&&this._okHandler.apply(this._ht,[t])},t.prototype.setGrey=function(t,e){e?t.filters=[this._colorFlilter]:t.filters=null},t.prototype.setGreyHalf=function(t,e){e?t.filters=[this._colorFlilter2]:t.filters=null},t.prototype.registTipHandler=function(t,e,i){void 0===i&&(i="description_json"),this._tipCallBack=t,this._tipThisObj=e,this._tipJsonName=i,this._tipInit||(this._tipInit=!0,this._tipObj=RES.getRes(this._tipJsonName))},t.prototype.getTip=function(t){return this._tipInit||(this._tipInit=!0,this._tipObj=RES.getRes(this._tipJsonName)),t.indexOf("helpTip_")>=0?this._tipObj[t.split("_")[1]]:""},t.prototype.addHelpTipHandler=function(t){t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.helpTapHandler,this)},t.prototype.helpTapHandler=function(t){var e=t.target.name,i=this.getTip(e);null!=this._tipCallBack&&null!=this._tipThisObj&&this._tipCallBack.apply(this._tipThisObj,[i,t.target])},t}();__reflect(NodepManager.prototype,"NodepManager");var RenderManager=function(){function t(){t._renderList=new Array}return t.getIns=function(){return this._ins||(this._ins=new t),this._ins},t.prototype.startRender=function(e){LogTrace.log("renderStart..."),t._stage=e,t._lastTime=egret.getTimer(),e.addEventListener(egret.Event.ENTER_FRAME,t.enterFrameHandler,t),window.addEventListener("message",function(e){"refresh"===e.data&&t.enterFrameHandler(null,!0)},!1)},t.enterFrameHandler=function(e,i){void 0===i&&(i=!1);var s,n=egret.getTimer(),r=n-t._lastTime,o=r;r>t._frameTime&&(t._bzCount+=r-t._frameTime),t._lastTime=n;var a=r,h=!1;do{var p=!0;(t._nodepTimered||!NodepManager.getIns().isActive)&&(p=!1);for(s in t._renderList)t._renderList[s].renderUpdate(a);h=!1}while(h);if((o>=1300&&!NodepManager.getIns().isActive||!NodepManager.getIns().isActive&&o>=1e3&&egret.Capabilities.isMobile)&&!t._nodepTimered){if(t._nodepTimered=!0,!t._iframe){var l=.03333;t._iframe=document.createElement("iframe"),t._iframe.id="nodepTimer",t._iframe.style.display="none",t._iframe.src="data:text/html,%3C%21DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%09%3Cmeta%20charset%3D%22utf-8%22%20%2F%3E%0A%09%3Cmeta%20http-equiv%3D%22refresh%22%20content%3D%22"+l+"%22%20id%3D%22metarefresh%22%20%2F%3E%0A%09%3Ctitle%3Ex%3C%2Ftitle%3E%0A%3C%2Fhead%3E%0A%3Cbody%3E%0A%09%3Cscript%3Etop.postMessage%28%27refresh%27%2C%20%27%2A%27%29%3B%3C%2Fscript%3E%0A%3C%2Fbody%3E%0A%3C%2Fhtml%3E"}document.body.insertBefore(t._iframe,document.body.childNodes[0])}if(!i&&t._nodepTimered){if(n-t._lastTimeredTime<1300){document.getElementById("nodepTimer");document.body.removeChild(document.getElementById("nodepTimer")),t._nodepTimered=!1,WinsManager.getIns().globActive()}t._lastTimeredTime=n}},t.prototype.registRender=function(e){t._renderList.indexOf(e)>=0||t._renderList.push(e)},t.prototype.unregistRender=function(e){var i=t._renderList.indexOf(e);i>=0&&t._renderList.splice(i,1)},t._lastTime=0,t._frameTime=1e3/60,t._nodepTimered=!1,t._lastTimeredTime=0,t.frameRate=60,t._bzCount=0,t}();__reflect(RenderManager.prototype,"RenderManager");var ScreenManager=function(){function t(e){navigator.userAgent.toLowerCase().indexOf("safari")<0||!egret.Capabilities.isMobile||e.stage.orientation==egret.OrientationMode.LANDSCAPE&&(t._baseUI=e,window.addEventListener("resize",this.windowResizeHandler),this.windowResizeHandler(null))}return t.prototype.windowResizeHandler=function(e){return window.innerHeight>window.innerWidth?(t._baseUI.scaleY=1,void window.scrollTo(0,0)):window.innerHeight>=document.documentElement.clientHeight?(t._baseUI.scaleY=1,void window.scrollTo(0,0)):(t._baseUI.scaleY=window.innerHeight/document.documentElement.clientHeight,void window.scrollTo(0,0))},t}();__reflect(ScreenManager.prototype,"ScreenManager");var SoundManager=function(){function t(){this._nowBg="",this.enable=!1,this._durTDic=new Map,this._soundDic=new Map}return t.getIns=function(){return null==t._ins&&(t._ins=new t),t._ins},t.prototype.playBg=function(t,e){if(void 0===e&&(e=0),this._nowBg!=t&&(this.enable||""==t)){if(this._nowBg=t,this._bgC){TweenTs.removeTweens(this._bgC);try{this._bgC.stop()}catch(i){}}var s=RES.getRes(t);s&&(this._bgC=s.play(0,e),null!=this._bgC&&(this._bgC.volume=0,TweenTs.get(this._bgC).to({volume:NodepConfig.bgVolume},3e3)))}},t.prototype.playSoundLoop=function(t,e){if(void 0===e&&(e=1),this.enable&&NodepManager.getIns().isActive&&null==this._soundDic.get(t)){var i=RES.getRes(t);if(i){var s=i.play(0,0);null!=s&&(s.volume=e,this._soundDic.set(t,s))}}},t.prototype.stopSoundLoop=function(t){if(null!=this._soundDic.get(t)){var e=this._soundDic.get(t);e.stop(),this._soundDic["delete"](t)}},t.prototype.playSound=function(t,e,i){if(void 0===e&&(e=1),void 0===i&&(i=0),this.enable&&NodepManager.getIns().isActive){if(i>0){null==this._durTDic.get(t)&&this._durTDic.set(t,0);var s=(new Date).getTime();if(s-this._durTDic.get(t)<i)return;this._durTDic.set(t,s)}var n=RES.getRes(t);if(n){var r=n.play(0,1);null!=r&&(r.volume=e)}}},t}();__reflect(SoundManager.prototype,"SoundManager");var WinsManager=function(){function t(){if(this._layerNames=[],this.$autoScaleX=1,this.$autoScaleY=1,null!=t._ins)throw new Error(NodepErrorType.ERROR_CODE);this._layerMap=new Map,this._windowMap=new Map}return t.getIns=function(){return t._ins||(t._ins=new t),t._ins},t.prototype.checkLayerVisible=function(){for(var t=!1,e=0;e<this._layerNames.length;e++){var i=this._layerNames[e],s=this._layerMap.get(i);t?s.visible=!1:(t=s.checkVisible(),s.visible=!0)}},t.prototype.initGame=function(e){NodepConfig.init(),this._baseUi=e,this._baseUi.stage.addEventListener(egret.Event.RESIZE,this.stageResizeHandler,this),this._sm=new ScreenManager(e),t.stageWidth=this._baseUi.stage.stageWidth,t.stageHeight=this._baseUi.stage.stageHeight,RenderManager.getIns().startRender(e.stage),this.addLayer(LayerType.LAYER_GROUND,new GameLayer),this.addLayer(LayerType.LAYER_BATTLE,new GameLayer),this.addLayer(LayerType.LAYER_MENU,new GameLayer),this.addLayer(LayerType.LAYER_UI,new GameLayer),this.addLayer(LayerType.LAYER_POP,new GameLayer),this.addLayer(LayerType.LAYER_TIP,new GameLayer,!1),this.autoScale(),LogTrace.log("initCompleted...")},t.prototype.addLayer=function(t,e,i){void 0===i&&(i=!0),i||(e.touchEnabled=e.touchChildren=i),this._layerNames.unshift(t),this._layerMap.set(t,e),this._baseUi.addChild(e),LogTrace.log("add layer:"+t)},t.prototype.switchWin=function(t){this._windowMap.has(t)||this._windowMap.set(t,new t);var e=this._windowMap.get(t);null==e.stage?this.openWindow(t):this.closeWin(t)},t.prototype.isInStage=function(t){if(!this._windowMap.has(t))return!1;var e=this._windowMap.get(t);return null!=e.parent},t.prototype.preOpenWindow=function(t){var e=NoAppResCenter.getGroupName(t);null!=e&&GroupResManager.getIns().loadGroup(e,null,null,!1,-1)},t.prototype.openWindow=function(t,e,i,s){if(void 0===e&&(e=!1),void 0===i&&(i=0),void 0===s&&(s=!0),t){var n=NoAppResCenter.getGroupName(t);1==NodepConfig.appMode&&null!=n?GroupResManager.getIns().loadGroup(n,this.readyOpen,this,s,0,[t,e,i]):(LogTrace.log("not app , mode="+NodepConfig.appMode+" gName="+n),this.readyOpen(t,e,i))}},t.prototype.readyOpen=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=0);var s=egret.getQualifiedClassName(t);this._windowMap.has(t)||this._windowMap.set(t,new t);var n=this._windowMap.get(t),r=DelayCall.removeCall("removeWin:self_frameworkForNode"+n.hashCode);if(n.stage)r&&n.reOpen();else{if(!this._layerMap.has(n.layerType))throw new Error(NodepErrorType.LAYER_NO_EXISTENT);e&&this._layerMap.get(n.layerType).clearLayer(),this._layerMap.get(n.layerType).addWindow(n,i),LogTrace.log("openWindow->"+n.typeName+"->"+s+":"+n.hashCode)}},t.prototype.openWindowToLayer=function(t,e){this._windowMap.has(t)||this._windowMap.set(t,new t);
var i=this._windowMap.get(t);if(!i.stage){if(!this._layerMap.has(e))throw new Error(NodepErrorType.LAYER_NO_EXISTENT);this._layerMap.get(e).addWindow(i,0),LogTrace.log("openWindow->"+i.typeName)}},t.prototype.closeWin=function(t){if(t){var e=null;switch(typeof t){case"object":e=t;break;case"string":break;case"function":e=this._windowMap.get(t)}e&&e.parent&&e.beforeClose()&&(e.needDelayRemove>0?DelayCall.call(e.needDelayRemove,this.removeWinReady,this,[e],1,"removeWin:self_frameworkForNode"+e.hashCode):this.removeWinReady(e))}},t.prototype.removeWinReady=function(t){LogTrace.log("closeWin:"+t.hashCode),t.parent&&(1==NodepConfig.auto?t.parent.parent.removeWindow(t):t.parent.removeWindow(t))},t.prototype.updateWin=function(t,e,i){void 0===i&&(i=null),this._windowMap.forEach(function(s){e.indexOf(s.typeName)>=0&&null!=s.stage&&s.update(t,i)},this)},t.prototype.globActive=function(){this._windowMap.forEach(function(t){null!=t.stage&&t.active()},this)},t.prototype.globalUpdate=function(t,e){this._windowMap.forEach(function(i){null!=i.stage&&i.update(t,e)},this)},t.prototype.stageResizeHandler=function(e){t.stageWidth=this._baseUi.stage.stageWidth,t.stageHeight=this._baseUi.stage.stageHeight,this.autoScale(),this._layerMap.forEach(function(t){t.resize()},this)},t.prototype.autoScale=function(){if(1==NodepConfig.auto){var e=t.stageWidth/window.innerWidth,i=t.stageHeight/window.innerHeight;i>=e&&window.innerWidth<window.innerHeight?this.$autoScaleY=i/e:this.$autoScaleY=1,this._layerMap.forEach(function(t){t.autoScale()},this)}},t.prototype.gcWindow=function(t){},t.prototype.gcWindowAll=function(){},t.prototype.gameStage=function(){return null!=this._baseUi?this._baseUi.stage:null},t.stageWidth=0,t.stageHeight=0,t}();__reflect(WinsManager.prototype,"WinsManager");var ObjPool=function(){function t(){}return t.create=function(t){var e=egret.getQualifiedClassName(t);this._poolMap.has(e)||this._poolMap.set(e,[]);var i=this._poolMap.get(e);return 0==i.length&&i.push(new t),i.pop()},t.release=function(t){var e=egret.getQualifiedClassName(t),i=this._poolMap.get(e);i&&i.push(t)},t._poolMap=new Map,t}();__reflect(ObjPool.prototype,"ObjPool");var EventDispatcher=function(){function t(){}return t.regist=function(t,e,i){this._lis.has(t)||this._lis.set(t,[]);var s=this._lis.get(t);s.push([e,i])},t.unregist=function(t,e,i){var s=this._lis.get(t);if(s)for(var n=0;n<s.length;n++)if(s[n][0]==e&&s[n][1]==i){s.splice(n,1);break}},t.dispatch=function(t,e){void 0===e&&(e=null);var i=this._lis.get(t);if(i)for(var s=0;s<i.length;s++)i[s][0].apply(i[s][1],e)},t._lis=new Map,t}();__reflect(EventDispatcher.prototype,"EventDispatcher");var SynResCenter=function(){function t(){}return t.getBitmapData=function(t){return this._btds.get(t)},t.hasBtd=function(t){return this._btds.has(t)},t.setBitmapData=function(t,e){this._btds.set(t,e)},t.setBitmapDataAsHeadCir=function(t,e){var i=(new egret.DisplayObjectContainer,new egret.Shape),s=new egret.DisplayObjectContainer,n=new egret.Bitmap(e);s.addChild(n),s.addChild(i);var r=new egret.RenderTexture;i.graphics.beginFill(0,1),i.graphics.drawCircle(e.width/2,e.height/2,e.width/2),i.graphics.endFill(),n.mask=i,r.drawToTexture(s),this._btds.set(t,r.bitmapData),e.$dispose()},t._btds=new Map,t}();__reflect(SynResCenter.prototype,"SynResCenter");var BitmapUtil=function(){function t(){}return t.createBitmapByName=function(t,e){void 0===e&&(e=!1);var i=new egret.Bitmap,s=RES.getRes(t);return i.texture=s,e&&(i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2),i},t.getBitmapTexture=function(t){return RES.getRes(t)},t.createSnapshot=function(t){var e=new egret.RenderTexture;e.drawToTexture(t);var i=new egret.Bitmap(e);return i},t.removeSnapshot=function(t){t.texture.dispose(),t.bitmapData&&t.bitmapData.$dispose()},t}();__reflect(BitmapUtil.prototype,"BitmapUtil");var DelayCall=function(){function t(t,e,i){void 0===i&&(i=null),this.key="",this.delayTime=0,this.repeatCount=0,this._costTime=0,this._callBack=t,this._thisObject=e,this._args=i}return t.call=function(e,i,s,n,r,o,a){void 0===n&&(n=null),void 0===r&&(r=1),void 0===o&&(o=""),void 0===a&&(a=!1),a&&this.removeCall(o);var h=new t(i,s,n);return h.delayTime=e,h.repeatCount=r,h.key=o,RenderManager.getIns().registRender(h),o&&""!=o&&t._delayMap.set(o,h),h},t.removeCall=function(t){if(!t||""==t)return!1;var e=this._delayMap.get(t);return e&&RenderManager.getIns().unregistRender(e),this._delayMap["delete"](t),null!=e},t.prototype.renderUpdate=function(e){for(this._costTime+=e;this._costTime>=this.delayTime;){if(this._costTime=this._costTime-this.delayTime,!(this.repeatCount>0)){null!=this._callBack&&this._callBack.apply(this._thisObject,this._args);break}if(this.repeatCount-=1,this.repeatCount<=0){t.removeCall(this.key),RenderManager.getIns().unregistRender(this),null!=this._callBack&&this._callBack.apply(this._thisObject,this._args),this._callBack=null,this._thisObject=null,this._args=null;break}null!=this._callBack&&this._callBack.apply(this._thisObject,this._args)}},t._delayMap=new Map,t}();__reflect(DelayCall.prototype,"DelayCall",["IRender"]);var NumberUtil=function(){function t(){}return t.getMoneyStr_1=function(t,e){void 0===e&&(e=",");for(var i="",s=t+"";s.length>0;)s.length>3?(i=e+s.substr(s.length-3,3)+i,s=s.substr(0,s.length-3)):(i=s.substr(0,s.length)+i,s="");return i==e&&(i="0"),i},t.getMoneyStr_2=function(t){var e=(t+"").length;return 6>=e?this.getMoneyStr_1(t,","):Math.floor(t/1e4)+"万"},t.getMoneyStr_3=function(t){if(t=parseInt(t+""),t>=1e4){var e=parseInt(t/1e4+""),i=parseInt(parseInt(t%1e4+"")/1e3+"");return i>0?e+"."+i+"萬":e+"萬"}return t+""},t.getMoneyStr_4=function(t){if(t=parseInt(t+""),t>=1e4){var e=parseInt(t/1e3+""),i=parseInt(parseInt(t%1e3+"")/100+"");return i>0?e+"."+i+"K":e+"K"}return t+""},t.getMoneyStr_5=function(t){if(t=parseInt(t+""),t>=1e3){var e=parseInt(t/1e3+""),i=parseInt(parseInt(t%1e3+"")/100+"");return i>0?e+"."+i+"K":e+"K"}return t+""},t.getRoundStr_1=function(t,e){void 0===e&&(e=2);for(var i=t+"";i.length<e;)i="0"+i;return i},t.getRoundStr_2=function(t,e){void 0===e&&(e=2);var i=t.toFixed(2);if(i.indexOf(".")>=0){var s=i.split(".");return s[0]+"."+this.getRoundStr_3(s[1])}return i+".00"},t.getRoundStr_3=function(t,e){for(void 0===e&&(e=2);t.length<e;)t+="0";return t},t.isPhoneNumber=function(t){return null!=t&&t.length>5},t.getHourFromMin=function(t){if(t=parseInt(t+""),t>=60){var e=parseInt(t/60+""),i=parseInt(parseInt(t%60+"")/6+"");return i>0?e+"."+i+"h":e+"h"}return t+"m"},t.getHourMin=function(t){0>t&&(t=0);var e=parseInt(t/1e3/60+""),i=parseInt(e/60+"");e=parseInt(e%60+"");var s=e+"";1==s.length&&(s="0"+s);var n=i+"";return 1==n.length&&(n="0"+n),n+":"+s},t.getMinSec=function(t){0>t&&(t=0);var e=parseInt(t/1e3/60+""),i=parseInt(t/1e3%60+""),s=e+"";1==s.length&&(s="0"+s);var n=i+"";return 1==n.length&&(n="0"+n),s+":"+n},t.getPhoneScr=function(t,e,i){void 0===e&&(e=3),void 0===i&&(i=4);for(var s=t.length,n="",r=0;s>r;r++)n+=r>=e&&s-i>r?"*":t.charAt(r);return n},t}();__reflect(NumberUtil.prototype,"NumberUtil");var FocusUtil=function(){function t(){}return t.focusImgBind=function(t,e,i,s){this.focusImgBindRemove(t);var n={img:e,inSrc:i,outSrc:s};this._imgBind.set(t,n),t.addEventListener(egret.Event.FOCUS_IN,this.focusImgInHandler,this),t.addEventListener(egret.Event.FOCUS_OUT,this.focusImgOutHandler,this)},t.focusImgBindRemove=function(t){this._imgBind.has(t)&&(t.removeEventListener(egret.Event.FOCUS_IN,this.focusImgInHandler,this),t.removeEventListener(egret.Event.FOCUS_OUT,this.focusImgOutHandler,this)),this._imgBind["delete"](t)},t.focusImgInHandler=function(t){var e=t.target,i=this._imgBind.get(e),s=i.img;s.source=i.inSrc},t.focusImgOutHandler=function(t){var e=t.target,i=this._imgBind.get(e),s=i.img;s.source=i.outSrc},t._imgBind=new Map,t}();__reflect(FocusUtil.prototype,"FocusUtil");var TimeUtil=function(){function t(){}return t.getTimeStr_1=function(t,e){void 0===e&&(e="-");var i="",s=new Date(t);return i=s.getFullYear()+e+NumberUtil.getRoundStr_1(s.getMonth()+1,2)+e+NumberUtil.getRoundStr_1(s.getDate(),2)},t.getTimeStr_2=function(t,e,i){void 0===e&&(e=":"),void 0===i&&(i=!1);var s="",n=new Date(t);return s=NumberUtil.getRoundStr_1(n.getHours(),2)+e+NumberUtil.getRoundStr_1(n.getMinutes(),2),i&&(s=s+e+NumberUtil.getRoundStr_1(n.getSeconds())),s},t.getTimeStr_3=function(t,e){void 0===e&&(e="-");var i="",s=new Date(t);return i=NumberUtil.getRoundStr_1(s.getMonth()+1,2)+e+NumberUtil.getRoundStr_1(s.getDate(),2)},t.getLastStr_1=function(t){return t>=60?parseInt(t/60+"")+"分":t+"秒"},t.getToday=function(e){return t.getTimeStr_1(e)},t.getYestoday=function(e){return t.getTimeStr_1(e-864e5)},t.getWeekStart=function(e){var i=new Date(e),s=0==i.getDay()?6:i.getDay()-1;return t.getTimeStr_1(e-24*s*60*60*1e3)},t.getMonthStart=function(e){var i=new Date(e);return i.setDate(1),t.getTimeStr_1(i.getTime())},t.getLastMonthStart=function(e){var i=new Date(e),s=i.getMonth()-1,n=i.getFullYear();0>s&&(s=11,n-=1);var r=new Date(n,s,1);return t.getTimeStr_1(r.getTime())},t.getLastMonthEnd=function(e){var i=new Date(e),s=i.getMonth()-1,n=i.getFullYear();0>s&&(s=11,n-=1);var r=new Date(n,s+1,0),o=r.getDate(),a=new Date(n,s,o);return t.getTimeStr_1(a.getTime())},t.getWeekCn=function(t){var e=t.split("-"),i=new Date(parseInt(e[0]),parseInt(e[1])-1,parseInt(e[2]));return this.weekNames[i.getDay()]},t.weekNames=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],t}();__reflect(TimeUtil.prototype,"TimeUtil");var EuiUtil=function(){function t(){}return t.getImage=function(t,e){void 0===e&&(e=null);var i=new eui.Image;return i.source=t,null!=e&&(i.scale9Grid=e),i},t}();__reflect(EuiUtil.prototype,"EuiUtil");var NodepUtil=function(){function t(){}return t.listFillTo01=function(t,e,i){void 0===i&&(i=!0);var s=0;if(i)for(s=0;s<e.length;s++)for(var n=e[s];n.length>0;)n.pop();for(s=0;s<t.length;s+=e.length)for(var r=0;r<e.length;r++)e[r].push(t[s+r])},t.fill=function(t,e,i,s,n){void 0===s&&(s=!1),void 0===n&&(n=null);for(var r;t.length>i;)r=t.pop(),s&&r.parent&&r.parent.removeChild(r);for(;t.length<i;)r=new e,t.push(r),s&&null!=n&&n.addChild(r)},t}();__reflect(NodepUtil.prototype,"NodepUtil");var ServerTime=function(){function t(){}return t.initBySec=function(t){DelayCall.removeCall("framework_servertime"),DelayCall.call(1e3,this.enterframe,this,null,0,"framework_servertime"),this._stime=1e3*t,this._startT=egret.getTimer()},t.getTime=function(){return this._stime+(egret.getTimer()-this._startT)},t.regist=function(t,e,i,s,n){this._groupNames.indexOf(t)<0&&this._groupNames.push(t),this._groupMap.has(t)||this._groupMap.set(t,[]);var r=this._groupMap.get(t),o={callBack:e,time:n,thisObj:i,arg:s};r.push(o),r.sort(function(t,e){return e.time-t.time})},t.delGroup=function(t){var e=this._groupNames.indexOf(t);if(!(0>e)){this._groupNames.splice(e,1);for(var i=this._groupMap.get(t);i.length>0;)i.pop();this._groupMap["delete"](t)}},t.isToday=function(t){var e=this.getTime();return TimeUtil.getTimeStr_1(e)==TimeUtil.getTimeStr_1(t)},t.enterframe=function(){var t=0,e=this.getTime();for(t;t<this._groupNames.length;t++)for(var i=this._groupNames[t],s=this._groupMap.get(i),n=s.length-1;n>=0;n--){var r=s[n];e>=r.time&&(r.callBack.apply(r.thisObj,r.arg),s.splice(n,1))}},t._stime=0,t._startT=0,t._groupMap=new Map,t._groupNames=[],t}();__reflect(ServerTime.prototype,"ServerTime");var ObjUtil=function(){function t(){}return t.copyTo=function(t,e){var i;for(i in e)t.hasOwnProperty(i)&&(e[i]=t[i])},t}();__reflect(ObjUtil.prototype,"ObjUtil");var ArraySole=function(){function t(t,e){this.datas=[],this._key=e,this._cls=t}return t.prototype.addOrUpdate=function(t){for(var e=null,i=0;i<this.datas.length;i++)if(this.datas[i][this._key]==t[this._key]){e=this.datas[i];break}e||(e=new this._cls,this.datas.push(e)),ObjUtil.copyTo(t,e)},t.prototype.addOrUpdateDatas=function(t){for(;t.length>0;)this.addOrUpdate(t.pop())},t.prototype.getSubBy=function(t,e){for(var i=[],s=0;s<this.datas.length;s++)this.datas[s][t]==e&&i.push(this.datas[s]);return i},t}();__reflect(ArraySole.prototype,"ArraySole");var DragonUtil=function(){function t(){}return t.getMc=function(e,i){var s;null==t._fcMap.get(e)&&(s=new dragonBones.EgretFactory,s.parseDragonBonesData(this.getJson(e+"_ske_json")),s.parseTextureAtlasData(this.getJson(e+"_tex_json"),RES.getRes(e+"_tex_png")),t._fcMap.set(e,s)),s=t._fcMap.get(e);var n;return n=s.buildArmatureDisplay(i)},t.getJson=function(t){return this._zipData.has(t)?this._zipData.get(t):RES.getRes(t)},t.registJson=function(t,e){this._zipData.set(t,e)},t._fcMap=new Map,t._zipData=new Map,t}();__reflect(DragonUtil.prototype,"DragonUtil");var Loader=function(t){function e(){var e=t.call(this)||this;return e.type=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"url",{get:function(){return this._url},set:function(t){this._url!=t&&(this._url=t,this.updateImg())},enumerable:!0,configurable:!0}),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._bit=new egret.Bitmap,this.addChild(this._bit),this.updateImg()},e.prototype.updateImg=function(){if(this._bit&&null!=this._url&&this._url.length>0&&void 0!=this._url&&"undefined"!=this._url){if(SynResCenter.hasBtd(this._url))return this._bit.bitmapData=SynResCenter.getBitmapData(this._url),this._bit.width=this.width,void(this._bit.height=this.height);var t=new egret.ImageLoader;t.addEventListener(egret.Event.COMPLETE,this.loadCompleted,this),t.addEventListener(egret.IOErrorEvent.IO_ERROR,this.loadError,this),t.load(this._url)}},e.prototype.loadError=function(t){LogTrace.log(this._url+":loader error!");var e=t.currentTarget;e.removeEventListener(egret.Event.COMPLETE,this.loadCompleted,this),e.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.loadError,this)},e.prototype.loadCompleted=function(t){var i=t.currentTarget;i.removeEventListener(egret.Event.COMPLETE,this.loadCompleted,this),i.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.loadError,this);var s=new egret.Texture;s._setBitmapData(i.data),this.type==e.HEAD_CIRCLE?SynResCenter.setBitmapDataAsHeadCir(this._url,s.bitmapData):SynResCenter.setBitmapData(this._url,s.bitmapData),this._bit.bitmapData=SynResCenter.getBitmapData(this._url),this._bit.width=this.width,this._bit.height=this.height},e.HEAD_CIRCLE=1,e}(eui.Component);__reflect(Loader.prototype,"Loader",["eui.UIComponent","egret.DisplayObject"]);var MenuGroup=function(){function t(t,e,i,s){void 0===s&&(s=!1),this._targetsPos=new Map,this._showed=!0,this._px=0,this._py=0,this._bar=t,this._imgs=e,this._targets=i;for(var n=0;n<this._targets.length;n++){var r=new egret.Point(this._targets[n].x,this._targets[n].y);this._targetsPos.set(this._targets[n],r)}this._bar.rotation=45,this._bar.source=this._imgs[1],this._bar.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showOrHide,this)}return Object.defineProperty(t.prototype,"isshowed",{get:function(){return this._showed},enumerable:!0,configurable:!0}),t.prototype.showOrHide=function(t){this._showed?(this.hide(),this._bar.source=this._imgs[0]):(this.show(),this._bar.source=this._imgs[1])},t.prototype.show=function(t){void 0===t&&(t=!0),TweenTs.get(this._bar).to({rotation:0},100),this._showed=!0;for(var e=0;e<this._targets.length;e++)TweenTs.get(this._targets[e]).to({alpha:1,x:this._targetsPos.get(this._targets[e]).x+this._px,y:this._targetsPos.get(this._targets[e]).y+this._py},100,t?nodep.Ease.backOut:null)},t.prototype.hide=function(){TweenTs.get(this._bar).to({rotation:45},100),this._showed=!1;for(var t=0;t<this._targets.length;t++)TweenTs.get(this._targets[t]).to({alpha:0,x:this._bar.x,y:this._bar.y},100)},t.prototype.offset=function(t,e){this._px=t,this._py=e},t}();__reflect(MenuGroup.prototype,"MenuGroup");var ListBox=function(){function t(t,e,i,s,n,r){void 0===i&&(i=0),void 0===s&&(s=0),void 0===n&&(n=0),void 0===r&&(r=!1),this._spY=0,this._everyH=0,this._datas=[],this._items=[],this._gcItemds=[],this._autoBottom=!0,this._bottomH=0,this._over=!1,this.toBottomSpeed=800,this.maxLen=0,this._needUp=!1,this._needDown=!1,this._over=r,this._box=t,this._cls=e,this._spY=i,this._everyH=s,this._bottomH=n,this._bottomH>0&&(this._bottomRect=new eui.Rect(1,this._bottomH,0),this._bottomRect.alpha=.01,this._box.addChild(this._bottomRect)),this._box.parent.addEventListener(eui.UIEvent.CHANGE,this.moveHandler,this),this._box.parent.addEventListener(eui.UIEvent.CHANGE_END,this.outHandler,this)}return t.prototype.initHandler=function(t,e,i,s,n){void 0===s&&(s=null),void 0===n&&(n=null),this._upH=t,this._downH=e,this._thisObj=i,this._autoB=s,this._autoT=n},t.prototype.initMoveHandler=function(t){this._mh=t},t.prototype.toTop=function(t,e){void 0===t&&(t=!0),void 0===e&&(e=!1);var i=0;TweenTs.removeTweens(this._box),e?TweenTs.get(this._box).to({scrollV:i},this.toBottomSpeed):this._box.scrollV=i,t&&DelayCall.call(50,this.toTop,this,[!1])},t.prototype.toBottom=function(t,e){void 0===t&&(t=!0),void 0===e&&(e=!1);var i=this._box.getBounds().height-this._box.scrollRect.height;0>i&&(i=0),i>=0&&i<this._box.getBounds().height&&(TweenTs.removeTweens(this._box),e?TweenTs.get(this._box).to({scrollV:i},this.toBottomSpeed):this._box.scrollV=i),t&&DelayCall.call(50,this.toBottom,this,[!1]),this.updateVisible()},t.prototype.updateVisible=function(){for(var t,e=0;e<this._items.length;e++)t=this._items[e],t.y+t.height<this._box.scrollV?t.$setVisible(!1):t.y>this._box.scrollV+this._box.scrollRect.height?t.$setVisible(!1):t.$setVisible(!0)},t.prototype.moveHandler=function(t){if(this._autoBottom=!1,this._box.scrollV<-100&&(this._needUp=!0),this._box.scrollV+this._box.scrollRect.height>this._box.getBounds().height+100&&(this._needDown=!0),null!=this._mh&&this._thisObj){var e=0;this._box.scrollV<0?e=-Math.min(this._box.scrollV/-100,1):this._box.scrollV+this._box.scrollRect.height>this._box.getBounds().height&&(e=Math.min((this._box.scrollV+this._box.scrollRect.height-this._box.getBounds().height)/100,1)),this._mh.apply(this._thisObj,[e])}this.updateVisible()},t.prototype.outHandler=function(t){this._box.scrollV>=this._box.getBounds().height-this._box.height-100&&(null!=this._autoB&&this._autoB.apply(this._thisObj,[!0]),this._autoBottom=!0),this._needUp&&(this._needUp=!1,0==this._box.scrollV&&this._upH&&this._thisObj&&this._upH.apply(this._thisObj,null)),this._needDown&&(this._needDown=!1,this._downH&&this._thisObj&&this._downH.apply(this._thisObj,null)),this.updateVisible()},t.prototype.pushOneToBottom=function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1),i&&(this._autoBottom=!0);var s;return s=this._gcItemds.length>0?this._gcItemds.pop():new this._cls,s.alpha=1,this._datas.push(t),s.updateData(t),this._box.addChild(s),this._items.push(s),this.checkLen(),e&&s.playIn(),this.updatePoses(!1,this._autoBottom,!0),DelayCall.call(1,this.updatePoses,this,[!1,this._autoBottom,!0]),!this._autoBottom},t.prototype.changeDatas=function(t){this._datas=t,this.checkLen(),this.updateDatas()},t.prototype.checkLen=function(){if(!(this.maxLen<=0)){for(;this._datas.length>this.maxLen;)this._datas.shift();for(var t;this._items.length>this._datas.length;)t=this._items.shift(),this._gcItemds.push(t),this._box.removeChild(t)}},t.prototype.removeOneByMc=function(t){var e=t;if(!(this._box.getChildIndex(t)<0)){var i=this._items.indexOf(e);i>=0&&this._items.splice(i,1),i=this._datas.indexOf(e.getData()),i>=0&&this._datas.splice(i,1),TweenTs.removeTweens(t),TweenTs.get(t).to({alpha:0,x:-t.width},100),DelayCall.call(120,this.removeOne,this,[t]),this.updatePoses(!0)}},t.prototype.removeOne=function(t){null!=t.parent&&t.parent.removeChild(t)},t.prototype.updateDatas=function(){var t,e=this._items.length-1;for(e;e>=0;e--)e>=this._datas.length&&(t=this._items[e],this._gcItemds.push(t),this._box.removeChild(t),this._items.splice(e,1));for(e=0;e<this._datas.length;e++)e>=this._items.length&&(t=this._gcItemds.length>0?this._gcItemds.pop():new this._cls,t.alpha=1,this._box.addChild(t),this._items.push(t));for(e=0;e<this._items.length;e++)t=this._items[e],t.updateData(this._datas[e]);this.updatePoses(),DelayCall.call(1,this.updatePoses,this)},t.prototype.updatePoses=function(t,e,i){void 0===t&&(t=!1),void 0===e&&(e=!1),void 0===i&&(i=!1);for(var s,n=0,r=0;r<this._items.length;r++)s=this._items[r],s.alpha=1,s.x=0,TweenTs.removeTweens(s),t?TweenTs.get(s).to({y:n},100):s.y=n,n+=this._everyH>0?this._everyH:s.height,n+=this._spY;null!=this._bottomRect&&(this._bottomRect.y=n,this._bottomRect.y<this._box.parent.height+100&&this._over&&(this._bottomRect.y=this._box.parent.height+100)),e&&this.toBottom(!0,i),this.updateVisible()},t}();__reflect(ListBox.prototype,"ListBox");var GameLayer=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._wins=[],e._popCount=0,e}return __extends(e,t),e.prototype.addWindow=function(t,e){t.visible=!1;var i=t;if(1==NodepConfig.auto&&null==t.parent){var s=new eui.Component;s.addChild(t),i=s}e>=0?this.addChild(i):this.addChildAt(i,0),this._wins.push(t),t.pop&&this._popCount++,this.updateModel(),t.__inited&&t.reOpen(),t.__inited=!0},e.prototype.clearLayer=function(){for(;this._wins.length>0;){var t=this._wins[0];this.removeWindow(t)}},e.prototype.removeWindow=function(t){t.pop&&this._popCount--,this.updateModel(),1==NodepConfig.auto?(this.removeChild(t.parent),t.parent.removeChild(t)):this.removeChild(t),this._wins.splice(this._wins.indexOf(t),1),WinsManager.getIns().checkLayerVisible()},e.prototype.checkVisible=function(){for(var t=this.numChildren,e=!1;t-->0;){var i=this.getChildAt(t);if(i==this._popShape)break;var s;i instanceof GameWindow?s=i:i.getChildAt(0)instanceof GameWindow&&(s=i.getChildAt(0)),s.visible=!e,s.isFull&&(e=!0)}return e},e.prototype.updateModel=function(){!(this._popCount>0)||this._popShape&&this._popShape.touchEnabled?this._popCount<=0&&this._popShape&&this._popShape.touchEnabled&&(this._popShape.touchEnabled=!1,TweenTs.get(this._popShape,!0,1,this.removePopShape,this).to({alpha:0},200)):(this._popShape||(this._popShape=new eui.Rect(100,100,0),this._popShape.alpha=0),this._popShape.width=WinsManager.stageWidth,this._popShape.height=WinsManager.stageHeight,this._popShape.touchEnabled=!0,this.addChildAt(this._popShape,0),TweenTs.get(this._popShape).to({alpha:.7},200))},e.prototype.removePopShape=function(){this._popShape.parent&&this._popShape.parent.removeChild(this._popShape)},e.prototype.resize=function(){var t;for(t in this._wins)this._wins[t].resize()},e.prototype.autoScale=function(){var t;for(t in this._wins)this._wins[t].autoScale()},e}(egret.DisplayObjectContainer);__reflect(GameLayer.prototype,"GameLayer",["GameLayerInterface"]);var NoAppResCenter=function(){function t(){}return t.initConfig=function(t){var e=RES.getRes(t);if(e&&null!=e.skinList&&null!=e.res)for(var i=e.skinList,s=e.res;i.length>0;){var n=i.pop();this._cfg.set(n,s[n])}},t.append=function(t,e){this._cfg.has(t)||this._cfg.set(t,[]);for(var i=this._cfg.get(t);e.length>0;){var s=e.pop();e.indexOf(s)<0&&i.push(s)}},t.getGroupName=function(t){var e=egret.getQualifiedClassName(t),i=this._cfg.get(e);return null==i?(LogTrace.log("winName="+e+" is emt"),null):(this._getted.indexOf(e)<0&&RES.createGroup(e,i,!0),e)},t._cfg=new Map,t._getted=[],t}();__reflect(NoAppResCenter.prototype,"NoAppResCenter");var net;!function(t){var e=function(){function t(){}return t.registerHandler=function(t,e,i){this._callBackMap.set(t,e),this._thisObjMap.set(t,i)},t.post=function(t,e,i){if(void 0===i&&(i=200),this.canSend(t)){var s=new egret.HttpRequest;this._requestMap.set(s,t),s.responseType=egret.HttpResponseType.TEXT,s.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),s.open(t,egret.HttpMethod.POST),s.send(e),s.addEventListener(egret.Event.COMPLETE,this.postCompletedHandler,this),s.addEventListener(egret.IOErrorEvent.IO_ERROR,this.postErrorHandler,this),LogTrace.log(t+"?"+e)}},t.postCompletedHandler=function(t){var e=t.currentTarget;e.removeEventListener(egret.Event.COMPLETE,this.postCompletedHandler,this),e.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.postErrorHandler,this),LogTrace.log("back:"+e.response);var i=this._requestMap.get(e);if(this.clear(e),null!=i){var s=this._callBackMap.get(i),n=this._thisObjMap.get(i);s.apply(n,[e.response])}else LogTrace.log("未注册的请求回置:"+e.response)},t.postErrorHandler=function(t){var e=t.currentTarget,i=this._requestMap.get(e);LogTrace.log("post error : "+i+":"+t.type),this.clear(e)},t.clear=function(t){var e=this._requestMap.get(t);null!=e&&(this._getting["delete"](e),this._requestMap["delete"](t))},t.canSend=function(t,e){if(void 0===e&&(e=200),null==this._getting.get(t))return this._getting.set(t,(new Date).getTime()+e),!0;var i=this._getting.get(t);return(new Date).getTime()>i?(this._getting.set(t,(new Date).getTime()+e),!0):!1},t._callBackMap=new Map,t._thisObjMap=new Map,t._getting=new Map,t._requestMap=new Map,t}();t.Http=e,__reflect(e.prototype,"net.Http")}(net||(net={}));var net;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.canReconnect=!0,e._handlerMap=new Map,e._handlerThis=new Map,e._tryConnect=!1,e._errorCount=3,e._reconnet=!1,e._timeout=5e3,e._locks=new Map,e._used=!1,e.delayRe=1e3,e._reTimes=[],e._nos=[],e._packOuts=[],e}return __extends(e,t),e.prototype.init=function(t,e){this._ip=t,this._port=e,this._url=t+":"+this._port,this.firstLink()},e.prototype.initByUrl=function(t){this._url=t,this.firstLink()},e.prototype.registHandlers=function(t,e){this._openHandler=t,this._openThisObj=e},e.prototype.regsitReconnect=function(t,e){this._reHandler=t,this._reThisObj=e},e.prototype.unLognos=function(t){for(;t.length>0;)this._nos.push(t.pop())},e.prototype.firstLink=function(){this._reTimes.push(egret.getTimer()),this._tryConnect=!0,this.type=egret.WebSocket.TYPE_BINARY,this.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this),LogTrace.log("尝试链接到服务器..."+this._url),DelayCall.call(this._timeout,this.onSocketError,this,null,1,"net_socket_self_frameworkForNodep"+this._errorCount),this.connectByUrl(this._url)},e.prototype.onReceiveMessage=function(t){var e=new egret.ByteArray;this.readBytes(e);var i=new PackIn(e.buffer);null!=this._handlerMap.get(i.code)?this._handlerMap.get(i.code).apply(this._handlerThis.get(i.code),[i]):this._nos.indexOf(i.code)<0&&LogTrace.log("socketMessage code="+i.code+"缺少处理")},e.prototype.onSocketOpen=function(){this._used=!0,LogTrace.log("连接成功"),RenderManager.getIns().registRender(this),LogTrace.log("WebSocketConnected!!"),this._errorCount=3,null!=this._openHandler&&this._openHandler.apply(this._openThisObj,[!this._reconnet]),null!=this._reHandler&&this._reconnet&&this._reHandler.apply(this._reThisObj,[!1])},e.prototype.onSocketClose=function(){LogTrace.log("连接断开"),this._tryConnect=!1,RenderManager.getIns().unregistRender(this),this.reconnet()},e.prototype.onSocketError=function(){this.reconnet()},e.prototype.registClose=function(t,e){this._closeHandler=t,this._closeT=e},e.prototype.reconnet=function(){if(!this.connected&&this.canReconnect){if(DelayCall.removeCall("net_socket_self_frameworkForNodep"+this._errorCount),this._reTimes.push(egret.getTimer()),this._reTimes.length>3){for(var t=0,e=0;3>e;e++)t+=this._reTimes[this._reTimes.length-e-1]-this._reTimes[this._reTimes.length-e-2];if(t/3<5*this.delayRe)return this.canReconnect=!1,void(null!=this._closeHandler&&this._closeHandler.apply(this._closeT,[this._used]))}this._errorCount--,this._errorCount>0?(this._reHandler&&this._reHandler.apply(this._reThisObj,[!0]),DelayCall.call(this.delayRe,this.readyReconnect,this,null,1,"net_socket_self_frameworkForNodepRe",!0)):null!=this._closeHandler&&this._closeHandler.apply(this._closeT,[this._used])}},e.prototype.readyReconnect=function(){this._reconnet=!0,this.connectByUrl(this._url),DelayCall.call(this._timeout,this.onSocketError,this,null,1,"net_socket_self_frameworkForNodep"+this._errorCount)},e.prototype.regist=function(t,e,i){if(this._handlerMap.has(t))throw new Error(NodepErrorType.NO_ALREADY_EXIST);this._handlerMap.set(t,e),this._handlerThis.set(t,i)},e.prototype.sendPack=function(t){this._locks.has(t.getCode())&&egret.getTimer()<this._locks.get(t.getCode())||(this._nos.indexOf(t.getCode())<0&&!this.connected&&LogTrace.log("尝试发送"+t.getCode()),this._packOuts.push(t))},e.prototype.renderUpdate=function(t){if(this.connected)for(;this._packOuts.length>0;){var e=this._packOuts.shift();this._nos.indexOf(e.getCode())<0&&LogTrace.log("实际发送"+e.getCode()),e.writeHead(),this.writeBytes(new egret.ByteArray(e.getBuffer()))}},e.prototype.setLock=function(t,e){this._locks.set(t,egret.getTimer()+e)},e.prototype.clearLock=function(t){this._locks["delete"](t)},e}(egret.WebSocket);t.Socket=e,__reflect(e.prototype,"net.Socket",["IRender"])}(net||(net={}));var PackIn=function(){function t(t){this._pos=0,this._signature=0,this.identifier=0,this.code=0,this.session=0,this.length=0,this._dataView=new DataView(t),this.identifier=this._dataView.getUint16(this._pos,!0),this._pos+=2,this.length=this._dataView.getUint16(this._pos,!0),this._pos+=2,this.code=this._dataView.getUint16(this._pos,!0),this._pos+=2,this._signature=this._dataView.getInt16(this._pos,!0),this._pos+=2,this.session=this._dataView.getUint16(this._pos,!0),this._pos+=2}return t.prototype.rewind=function(){this._pos=10},t.prototype.readJson=function(){return JSON.parse(this.readString())},t.prototype.readBool=function(){var t=this._dataView.getInt8(this._pos);return++this._pos,1==t},t.prototype.readBoolean=function(){return this.readBool()},t.prototype.readInteger=function(){var t=0,e=this._dataView.getUint8(this._pos);switch(this._pos+=1,e){case 255:t=this._dataView.getInt8(this._pos),this._pos+=1;break;case 254:t=this._dataView.getInt16(this._pos,!0),this._pos+=2;break;case 253:t=this._dataView.getUint16(this._pos,!0),this._pos+=2;break;case 252:t=this._dataView.getInt32(this._pos,!0),this._pos+=4;break;case 251:t=this._dataView.getUint32(this._pos,!0),this._pos+=4;break;case 250:for(var i="",s=0;8>s;++s){var n=this._dataView.getUint8(this._pos),r=n.toString(2);i=r+i;for(var o=r.length;8>o;++o)i="0"+i;this._pos+=1}t=parseInt(i,2);break;case 249:for(var i="",s=0;8>s;++s){var n=this._dataView.getUint8(this._pos),r=n.toString(2);i=r+i;for(var o=r.length;8>o;++o)i="0"+i;this._pos+=1}t=parseInt(i,2);break;default:t=e}return t},t.prototype.readInt=function(){return this.readInteger()},t.prototype.readString=function(){var t=this.readByteArray();return UTF8.byteArrayToString(t)},t.prototype.readByteArray=function(){for(var t=this.readInteger(),e=new Uint8Array(t),i=0;t>i;++i)e[i]=this._dataView.getUint8(this._pos),this._pos+=1;return e},t.prototype.readFloat=function(){var t=this._dataView.getFloat32(this._pos,!0);return this._pos+=4,t},t.prototype.readDouble=function(){var t=this._dataView.getFloat64(this._pos,!0);return this._pos+=8,t},t.prototype.readListAny=function(t){for(var e=[],i=this.readInteger(),s=0;i>s;++s){for(var n=[],r=0;r<t.length;r++)n.push(t[r].call(this));e.push(n)}return e},t.prototype.readList=function(t){for(var e=[],i=this.readInteger(),s=0;i>s;++s)null!=t?e.push(t.call(this)):e.push(this.readInt());return e},t.prototype.readList2=function(t,e){void 0===e&&(e=2);for(var i=[],s=this.readInteger(),n=0;s>n;++n){for(var r=[],o=0;e>o;o++)r.push(t.call(this));i.push(r)}return i},t}();__reflect(PackIn.prototype,"PackIn");var PackOut=function(){function t(e,i){void 0===i&&(i=1024),this._session=0,this._code=0,this._length=10,this._pos=10,t.addS++,this._session=t.addS,this._buffer=new ArrayBuffer(i),this._code=e,this._dataView=new DataView(this._buffer,0)}return t.prototype.getCode=function(){return this._code},t.prototype._ensureLength=function(){this._length<this._pos&&(this._length=this._pos)},t.prototype.getBuffer=function(){return this._buffer.slice(0,this._length)},t.prototype.setSession=function(t){this._session=t
},t.prototype.getSession=function(){return this._session},t.prototype.writeHead=function(){this._pos=0,this._dataView.setUint16(this._pos,56430,!0),this._pos+=2,this._dataView.setUint16(this._pos,this._length,!0),this._pos+=2,this._dataView.setUint16(this._pos,this._code,!0),this._pos+=2,this._dataView.setInt16(this._pos,0,!0),this._pos+=2,this._dataView.setUint16(this._pos,this._session,!0),this._pos+=2,this._ensureLength()},t.prototype.writeDouble=function(t){this._dataView.setFloat64(this._pos,t,!0),this._pos+=8,this._ensureLength()},t.prototype.writeInteger=function(t){if(t>=0)if(249>t)this._dataView.setUint8(this._pos,t),this._pos+=1;else if(32767>=t)this._dataView.setUint8(this._pos,254),this._pos+=1,this._dataView.setInt16(this._pos,t,!0),this._pos+=2;else if(2147483647>=t)this._dataView.setUint8(this._pos,252),this._pos+=1,this._dataView.setInt32(this._pos,t,!0),this._pos+=4;else{this._dataView.setUint8(this._pos,250),this._pos+=1;for(var e=t.toString(2),i=e.length,s=8;s>0;)i>0?i>=8?(t=parseInt(e.substr(i-8,8),2),i-=8):(t=parseInt(e.substr(0,i),2),i=0):t=0,this._dataView.setUint8(this._pos,t),this._pos+=1,--s}else if(t>=-128)this._dataView.setUint8(this._pos,255),this._pos+=1,this._dataView.setInt8(this._pos,t),this._pos+=1;else if(t>=-32768)this._dataView.setUint8(this._pos,254),this._pos+=1,this._dataView.setInt16(this._pos,t,!0),this._pos+=2;else if(t>=-2147483648)this._dataView.setUint8(this._pos,252),this._pos+=1,this._dataView.setInt32(this._pos,t,!0),this._pos+=4;else{this._dataView.setUint8(this._pos,250),this._pos+=1;for(var e=t.toString(2),i=e.length,s=8;s>0;)i>0?i>=8?(t=parseInt(e.substr(i-8,8),2),i-=8):(t=parseInt(e.substr(0,i),2),i=0):t=0,this._dataView.setUint8(this._pos,t),this._pos+=1,--s}this._ensureLength()},t.prototype.writeString=function(t){t=t||"";var e=UTF8.stringToByteArray(t);this.writeInteger(e.length);for(var i=0;i<e.length;++i)this._dataView.setUint8(this._pos,e[i]),this._pos+=1;this._ensureLength()},t.prototype.writeBytes=function(t){this.writeInteger(t.byteLength);for(var e=0;e<t.byteLength;e++)this._dataView.setUint8(this._pos,t[e]),this._pos+=1;this._ensureLength()},t.prototype.writeBoolean=function(t){this._dataView.setInt8(this._pos,t?1:0),this._pos+=1,this._ensureLength()},t.prototype.writeFloat=function(t){this._dataView.setFloat32(this._pos,t,!0),this._pos+=4,this._ensureLength()},t.prototype.writeList=function(t,e){this.writeInteger(t.length);var i;for(i in t)e.call(this,t[i])},t.prototype.dumpInfo=function(){LogTrace.log(this._code);var t=new egret.ByteArray(this.getBuffer());t.position=0;for(var e="",i=0;i<t.length;++i)e+=t[i]+",";LogTrace.log(e)},t.addS=0,t}();__reflect(PackOut.prototype,"PackOut");var nodep;!function(t){var e=function(){function t(t){this.type=t}return t.prototype.dispose=function(){this.props=null,this.ease=null},t}();t.TweenItem=e,__reflect(e.prototype,"nodep.TweenItem")}(nodep||(nodep={}));